name: Cron - Processar Pedido Venda Omie

on:
  schedule:
    - cron: '* * * * *'  # a cada 1 minuto
  workflow_dispatch:

jobs:
  call-edge:
    runs-on: ubuntu-latest

    steps:
      - name: Chamar Edge processar_pedido_venda_omie
        run: |
          echo ">>> Chamando Edge processar_pedido_venda_omie"
          curl -i -m 30 -X POST \
            https://qxfaqtjlnskxozrywyku.functions.supabase.co/processar_pedido_venda_omie \
            -H "Content-Type: application/json" \
            -H "X-Internal-Token: ${{ secrets.IPCAN_INTERNAL_TOKEN }}" \
            -d '{}' || exit 1
          echo ">>> Edge finalizada"
